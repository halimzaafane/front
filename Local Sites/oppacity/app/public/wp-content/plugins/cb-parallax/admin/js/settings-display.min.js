(function(b){function a(){this.cb_Parallax=Cb_Parallax_Admin;this.canParallax=undefined!==this.cb_Parallax.image_options.can_parallax?this.cb_Parallax.image_options.can_parallax:"0";this.parallaxEnabledSwitch=null;this.placeholderImage=null;this.backgroundImage=null;this.attachmentId=null;this.CheckBoxes=null;this.parallaxDirectionSelectBox=null;this.addMediaButton=null;this.removeMediaButton=null;this.settingsForm=null;this.submitButton=null;this.resetButton=null;this.allImageOptions=null;this.staticImageOptions=null;this.parallaxImageOptions=null;this.attachmentWidth=this.cb_Parallax.image_data.image_width!==undefined?this.cb_Parallax.image_data.image_width:0;this.attachmentHeight=this.cb_Parallax.image_data.image_height!==undefined?this.cb_Parallax.image_data.image_height:0;this.verticalScrollDirectionContainer=null;this.horizontalScrollDirectionContainer=null;this.verticalAlignmentContainer=null;this.horizontalAlignmentContainer=null;this.direction=undefined!==this.cb_Parallax.image_options.cb_parallax_direction?this.cb_Parallax.image_options.cb_parallax_direction:this.cb_Parallax.default_options.cb_parallax_direction}a.prototype={constructor:function(){this.cb_Parallax=Cb_Parallax_Admin;this.canParallax=undefined!==this.cb_Parallax.image_options.can_parallax?this.cb_Parallax.image_options.can_parallax:"0";this.parallaxEnabledSwitch=null;this.placeholderImage=null;this.backgroundImage=null;this.attachmentId=null;this.CheckBoxes=null;this.parallaxDirectionSelectBox=null;this.addMediaButton=null;this.removeMediaButton=null;this.settingsForm=null;this.submitButton=null;this.resetButton=null;this.allImageOptions=null;this.staticImageOptions=null;this.parallaxImageOptions=null;this.attachmentWidth=this.cb_Parallax.image_data.image_width!==undefined?this.cb_Parallax.image_data.image_width:0;this.attachmentHeight=this.cb_Parallax.image_data.image_height!==undefined?this.cb_Parallax.image_data.image_height:0;this.verticalScrollDirectionContainer=null;this.horizontalScrollDirectionContainer=null;this.verticalAlignmentContainer=null;this.horizontalAlignmentContainer=null;this.direction=undefined!==this.cb_Parallax.image_options.cb_parallax_direction?this.cb_Parallax.image_options.cb_parallax_direction:this.cb_Parallax.default_options.cb_parallax_direction},init:function(){this.initColorpicker();this.initFancySelect();this.assembleSettingsContainers();this.localizeScript();this.initSettingsDisplay();this.addEvents();this.initContextualHelp()},assembleSettingsContainers:function(){this.allImageOptions=b("#cb_parallax_parallax_enabled_container, #cb_parallax_background_color_container, #cb_parallax_direction_container, #cb_parallax_vertical_scroll_direction_container, #cb_parallax_horizontal_scroll_direction_container, #cb_parallax_horizontal_alignment_container, #cb_parallax_vertical_alignment_container, #cb_parallax_overlay_image_container, #cb_parallax_overlay_opacity_container, #cb_parallax_overlay_color_container, #cb_parallax_background_repeat_container, #cb_parallax_position_x_container, #cb_parallax_position_y_container, #cb_parallax_background_attachment_container");this.parallaxImageOptions=b("#cb_parallax_parallax_enabled_container, #cb_parallax_background_color_container, #cb_parallax_direction_container, #cb_parallax_vertical_scroll_direction_container, #cb_parallax_horizontal_scroll_direction_container, #cb_parallax_horizontal_alignment_container, #cb_parallax_vertical_alignment_container, #cb_parallax_overlay_image_container, #cb_parallax_overlay_opacity_container, #cb_parallax_overlay_color_container");this.staticImageOptions=b("#cb_parallax_parallax_enabled_container, #cb_parallax_background_color_container, #cb_parallax_background_repeat_container, #cb_parallax_position_x_container, #cb_parallax_position_y_container, #cb_parallax_background_attachment_container, #cb_parallax_overlay_image_container, #cb_parallax_overlay_opacity_container, #cb_parallax_overlay_color_container");this.verticalScrollDirectionContainer=b("#cb_parallax_vertical_scroll_direction_container");this.horizontalScrollDirectionContainer=b("#cb_parallax_horizontal_scroll_direction_container");this.verticalAlignmentContainer=b("#cb_parallax_vertical_alignment_container");this.horizontalAlignmentContainer=b("#cb_parallax_horizontal_alignment_container");this.parallaxEnabledSwitch=b(".cb_parallax_parallax_enabled");this.placeholderImage=b(".cb_parallax_placeholder_image");this.backgroundImage=b(".cb_parallax_background_image");this.attachmentId=b(".cb_parallax_attachment_id");this.CheckBoxes=b(".cb-parallax-input-checkbox");this.parallaxDirectionSelectBox=b("[data-key='cb_parallax_direction']");this.parallaxDirectionSelectBoxTrigger=b("#cb_parallax_direction_container").find("div.trigger");this.parallaxSettingsTitle=b("h3.parallax");this.staticSettingsTitle=b("h3.static");this.addMediaButton=b(".cb-parallax-media-url");this.removeMediaButton=b(".cb-parallax-remove-media");this.settingsForm=b("#cb_parallax_settings_form");this.submitButton=b("#cb_parallax_form_submit");this.resetButton=b("#cb_parallax_form_reset")},initColorpicker:function(){b(".cb-parallax-color-picker").wpColorPicker()},initFancySelect:function(){b(".cb-parallax-fancy-select").fancySelect()},localizeScript:function(){b('<style>.cb-parallax-switch-input ~ .cb-parallax-switch-label:before{content:"'+this.cb_Parallax.strings.switches_text.Off+'";}</style>').appendTo("head");b('<style>.cb-parallax-switch-input:checked ~ .cb-parallax-switch-label:after{content:"'+this.cb_Parallax.strings.switches_text.On+'";}</style>').appendTo("head")},addEvents:function(){this.CheckBoxes.on("click",this.toggleCheckbox);this.parallaxDirectionSelectBoxTrigger.on("change",{context:this},this.toggleParallaxEnabledCheckbox);this.parallaxEnabledSwitch.on("change",{context:this},this.initSettingsDisplay);this.parallaxDirectionSelectBox.on("change.fs",{context:this},this.toggleParallaxEnabledCheckbox);this.removeMediaButton.on("click",{context:this},this.removeMedia);this.addMediaButton.on("click",{context:this},this.addMedia);this.submitButton.on("click",{context:this},this.cbparallaxSaveOptions);this.resetButton.on("click",{context:this},this.cbparallaxResetOptions)},initSettingsDisplay:function(c){let $this=this;if(undefined!==c){$this=c.data.context}$this.allImageOptions.hide();$this.removeMediaButton.hide();$this.removeMediaButton.show();if("1"===$this.canParallax&&$this.parallaxEnabledSwitch.prop("checked")){$this.staticImageOptions.hide();$this.parallaxImageOptions.show()}else{$this.parallaxImageOptions.hide();$this.staticImageOptions.show()}$this.toggleParallaxEnabledCheckbox()},toggleParallaxEnabledCheckbox:function(c){let $this=this;if(undefined!==c){c.preventDefault();$this=c.data.context}$this.parallaxSettingsTitle.addClass("hidden");$this.staticSettingsTitle.addClass("hidden");b($this.parallaxDirectionSelectBox).trigger("change.$");if(""!==$this.backgroundImage.attr("src")){$this.parallaxSettingsTitle.removeClass("hidden");if($this.parallaxEnabledSwitch.prop("checked")){if($this.parallaxDirectionSelectBoxTrigger.text()==="horizontal"){$this.horizontalScrollDirectionContainer.show();$this.verticalAlignmentContainer.show();$this.verticalScrollDirectionContainer.hide();$this.horizontalAlignmentContainer.hide()}else{$this.verticalScrollDirectionContainer.show();$this.horizontalAlignmentContainer.show();$this.horizontalScrollDirectionContainer.hide();$this.verticalAlignmentContainer.hide()}}else{$this.verticalScrollDirectionContainer.hide();$this.horizontalAlignmentContainer.hide();$this.horizontalScrollDirectionContainer.hide();$this.verticalAlignmentContainer.hide()}}else{$this.verticalScrollDirectionContainer.hide();$this.horizontalAlignmentContainer.hide();$this.horizontalScrollDirectionContainer.hide();$this.verticalAlignmentContainer.hide();$this.staticSettingsTitle.removeClass("hidden")}},toggleCheckbox:function(){if("0"===b(this).val()){b(this).val("1")}else{b(this).val("0")}},addMedia:function(c){c.preventDefault();let $this=c.data.context;let cb_parallax_frame=wp.media({className:"media-frame cb-parallax-frame",frame:"select",multiple:false,title:cbParallaxMediaFrame.title,library:{type:"image"},button:{text:cbParallaxMediaFrame.button}});cb_parallax_frame.on("select",function(){let media_attachment=cb_parallax_frame.state().get("selection").first().toJSON();$this.attachmentId.val(media_attachment.id);$this.backgroundImage.attr("src",media_attachment.url);$this.placeholderImage.hide();b("[data-key='cb_parallax_background_image_url']").val(media_attachment.url);b("[data-key='cb_parallax_background_image_url_hidden']").val(media_attachment.url);b("[data-key='cb_parallax_attachment_id']").val(media_attachment.id);$this.addMediaButton.addClass("disabled");$this.attachmentHeight=media_attachment.height;$this.attachmentWidth=media_attachment.width;$this.initSettingsDisplay()});cb_parallax_frame.open()},removeMedia:function(c){c.preventDefault();let $this=c.data.context;$this.backgroundImage.attr("src","");$this.placeholderImage.show();$this.attachmentId.val("");$this.attachmentHeight=0;$this.attachmentWidth=0;b("[data-key='cb_parallax_background_image_url_hidden']").val("");b("[data-key='cb_parallax_attachment_id']").val("");$this.addMediaButton.removeClass("disabled");$this.initSettingsDisplay();return false},cbparallaxSaveOptions:function(c){c.preventDefault();let $this=c.data.context;let input={};let dataForm=$this.settingsForm.data("form");let optionKeys="image"===dataForm?$this.cb_Parallax.option_keys.image:$this.cb_Parallax.option_keys.all;b.each(optionKeys,function(){input[this]=b("[data-key='"+this+"']").val()});let data={action:"cb_parallax_save_options",nonce:$this.settingsForm.data("nonce"),input:input,post_id:$this.settingsForm.data("postid")};b.post(ajaxurl,data,function(d){if(d.success===true){alert($this.cb_Parallax.strings.save_options_ok)}else{alert($this.cb_Parallax.strings.save_options_error)}});$this.initSettingsDisplay();return false},cbparallaxResetOptions:function(c){c.preventDefault();let $this=c.data.context;let data={action:"cb_parallax_reset_options",nonce:$this.settingsForm.data("nonce"),post_id:$this.settingsForm.data("postid")};if(!confirm($this.cb_Parallax.strings.reset_settings_confirmation)){return false}b.post(ajaxurl,data,function(d){if(d.success===true){$this.resetOptionsPageInputFields();b("");alert($this.cb_Parallax.strings.reset_options_ok)}else{alert($this.cb_Parallax.strings.reset_options_error)}})},resetOptionsPageInputFields:function(){let dataForm=this.settingsForm.data("form");let optionKeys="image"===dataForm?this.cb_Parallax.option_keys.image:this.cb_Parallax.option_keys.all;let $this=this;b.each(optionKeys,function(){let element=b("[data-key="+this+"]");let value=$this.cb_Parallax.default_options[this];if("checkbox"===element.attr("type")){b(element).val("0").prop("checked","")}else{if("text"===element.attr("type")){b(element).wpColorPicker("color","transparent")}else{if("select"===element.attr("type")){element.val(value);let list=b(element).parent().find("ul.options");let listElements=b(list).find("li");b(listElements).removeAttr("class");b(list).find(b("li[data-raw-value="+this+"]")).addClass("selected");b(element).parent().find(".trigger").html(value)}else{b(element).val(value)}}}});this.backgroundImage.attr("src","");this.placeholderImage.show();b("[data-key='cb_parallax_background_image_url_hidden']").val("");b("[data-key='cb_parallax_attachment_id']").val("")},initContextualHelp:function(){b("#cb-parallax-help-tabs").tabs()}};b(document).one("ready",function(){let cbParallaxSettingsDisplay=new a();cbParallaxSettingsDisplay.init()})})(jQuery);